% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/des.R
\name{des_simulate}
\alias{des_simulate}
\title{DES drydown simulator (mono-layer) with daily rain/ET, LAI-based partition, and power-law drainage}
\usage{
des_simulate(
  Ks,
  n,
  theta_init,
  ET_vec,
  rain_vec = NULL,
  LAI_vec = NULL,
  k_ext = 0.378,
  LAI_default = 1,
  theta_r,
  theta_s,
  theta_fc,
  theta_star,
  theta_wp,
  psi_b,
  root_depth = 0.6,
  dt = 1/24,
  dz = 0.05,
  desorp = TRUE,
  analytical = FALSE,
  debug = FALSE,
  hourly = TRUE,
  rain_split = c("first", "uniform")
)
}
\arguments{
\item{Ks}{saturated hydraulic conductivity [m/day]}

\item{n}{van Genuchten n parameter [-] (also used to shape K(\theta) power via p = 1/n)}

\item{theta_init}{initial water content [m3/m3]}

\item{ET_vec}{daily potential evapotranspiration [mm/day] (required)}

\item{rain_vec}{daily rainfall [mm/day] (default all zeros if omitted)}

\item{LAI_vec}{daily leaf area index [-]; if NULL, uses \code{LAI_default}}

\item{k_ext}{light extinction coefficient for ET partition [-], default 0.378}

\item{LAI_default}{scalar LAI used if \code{LAI_vec} is NULL (default 1)}

\item{theta_r}{residual water content [m3/m3]}

\item{theta_s}{saturated water content [m3/m3]}

\item{theta_fc}{field capacity [m3/m3]}

\item{theta_star}{optimal water content (no stress) [m3/m3]}

\item{theta_wp}{wilting point [m3/m3]}

\item{psi_b}{bubbling pressure [m]}

\item{root_depth}{rooting depth [m] (default 0.60)}

\item{dt}{sub-step length for dry days [days], e.g. 1/24 (default)}

\item{dz}{layer thickness [m] (default 0.05)}

\item{desorp}{use DES-style cumulative evaporation on dry days (default TRUE)}

\item{analytical}{if TRUE use \code{update_theta_analytical()} for drainage on dry days;
otherwise use the power-law K(\theta) (default FALSE)}

\item{debug}{verbose console messages (default FALSE)}

\item{hourly}{return sub-daily expanded output (true within-day evolution) (default TRUE)}

\item{rain_split}{placeholder for future rain distribution options (default "first")}
}
\value{
A list with:
\itemize{
  \item \code{series}: per-step (expanded) and daily time series:
    \describe{
      \item{\code{theta}}{sub-daily \theta (length = n_day * n_substeps) if \code{hourly=TRUE}, else daily}
      \item{\code{evap_mm}, \code{transp_mm}, \code{drain_mm}, \code{overflow_mm}}{sub-daily (or daily) fluxes in mm}
      \item{\code{theta_daily}, \code{evap_daily_mm}, \code{transp_daily_mm}, \code{drain_daily_mm}, \code{overflow_daily_mm}}{daily series}
    }
  \item \code{meta}: units, flags, structure parameters.
}
}
\description{
DES drydown simulator (mono-layer) with daily rain/ET, LAI-based partition, and power-law drainage
}
