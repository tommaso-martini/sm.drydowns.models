% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/musec.R
\name{musec_simulate}
\alias{musec_simulate}
\title{muSEC simulator (mono- or multi-layer)}
\usage{
musec_simulate(
  theta_init,
  structure,
  Ks,
  n,
  theta_s,
  theta_r,
  theta_fc,
  theta_wp,
  theta_star,
  ET = NULL,
  E = NULL,
  T = NULL,
  LAI = NULL,
  k_ext = 0.378,
  LAI_default = 1,
  timestep = c("hourly", "daily"),
  hourly_out = FALSE,
  exp_drain = TRUE,
  roots_depth = NULL,
  debug = FALSE
)
}
\arguments{
\item{theta_init}{numeric scalar (mono-layer) or numeric vector (multi-layer, top→bottom) in m3/m3}

\item{structure}{list:
- mono: list(dz = <thickness [m]>)
- multi: list(depths = <centres [m]>, dz = <thicknesses [m]>)}

\item{Ks, n, theta_s, theta_r, theta_fc, theta_wp, theta_star}{hydraulic and stress parameters}

\item{ET}{numeric [mm/step], optional (alternative to E+T)}

\item{E, T}{numeric [mm/step], optional (if already partitioned)}

\item{LAI}{numeric scalar/vector; if NULL uses LAI_default}

\item{k_ext}{light-extinction coefficient (default 0.378)}

\item{LAI_default}{default LAI when missing (default 1)}

\item{timestep}{"hourly" or "daily" (if daily → hourly expansion with sinusoid)}

\item{hourly_out}{if TRUE and mono-layer, also returns daily means}

\item{exp_drain}{if TRUE uses exponential K calibrated at s_fc; else power-law K_theta()}

\item{roots_depth}{max rooting depth [m] for multi-layer; default = profile bottom}

\item{debug}{verbose diagnostics}
}
\value{
list(mode = "mono"/"multi", series = ..., meta = ...)
}
\description{
Simulates muSEC with SEC evaporation at the surface layer, drainage (exponential or power-law),
and transpiration with Feddes stress, for mono- and multi-layer configurations.
}
